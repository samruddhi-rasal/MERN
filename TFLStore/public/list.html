<!DOCTYPE html>
<html>  
<head>
    <title>Flower List</title>
    <!--Step 1 : link jQuery file available-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>
<body>
    <h1>Available Flowers For Sale...</h1>
    <hr/>

    <button>GetFlowers</button>
    <ol id="Flowers List">
    </ol>
    <p id="para"></p>
    <script>
        //In module AWP
        // HTML JS jQuery CSS
        //HTML syntax for content
        //javascript syntax for logic implementation 
        //jQuery syntax for DOM , Ajax, event handling
        // which code script block
        //javascript syntax = addon syntax of jQuery

        //Classical : Ajax Technique
        // make a query for REST API 
        //once data available successfully will be able to print or set to HTML element
        //if data does not arrive and fail will be able to print error on console of browser
        // using library jQuery library

        //JQuery is used to provide Event Handling, DOM Manipultion and Ajax at client side (in HTML and Browser)
        
        //$ in JQuery is defined as selector
        //u can consider it behave like a reference in java
        //u can consider it behave like a pointer in C , C++

        //Step 2 : Write event handler for document.ready
        $(document).ready(function(){
            //Step 3 : Add event handler for button click
            //get element id by button 
            console.log("Document is Ready...");
            $("button").click(function(){
                //Step 4 :  
                //get data from server using $.get method
                console.log("Button Clicked...");
                var p=document.getElementById("para");
                //make asynchronous javascript call using $.get
                //first parameter is always relative url of your web api (REST API)
                //second parameter is always callback function
                //which will be invoked on recieved response from server REST API
                
                // -> this is CPP way of calling point method
                //.   this is java way of calling reference method
                //$.  is jQuery way of callling method which is inbuit in jQuery

                
                $.get("/api/flowers",function(data,status){ //$.get is a ready made function to make GET request
                    //Step 5 : fetch data and iterate to show each flower name using paragraph element
                    //console.log("Data: " + data + "\nStatus: "+status);
                    //alert("Data: " + data +  JSON.stringify(data.data) + "\nStatus: "+status);
                    console.log(data);
                    for(var i=0;i<data.length;i++){
                        console.log(data[i].name);
                        //Append child to element which is OL
                        var ol = document.getElementById("flowerslist");

                        ol.appendChild(data[i]);
                        p.innerHTML=p.innerHTML + " "+ data[i].name;
                    }
                });
                
                });
            });
        

        /*//fetch data from server 
        //Handling asynchronous operation using async await
        async function getFlowersFromTFLStore(){
        var flowersUrl="api/flowers";
        //any function you invoke outside is going to be asynchronous by nature
        try{
            let response=await fetch(flowersUrl); //any asynchronous method call await keyword is used to wait for the response(result)
            consolelog(response.body);
        }
        catch(err){
            console.log(err);
        }
     };
    //function is invoked at this place 
    getFlowersFromTFLStore();
    */
    </script>
</body>
</html>